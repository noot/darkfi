<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Helper utilities"><title>darkfi::validator::utils - Rust</title><script> if (window.location.protocol !== "file:") document.write(`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2">`)</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="darkfi" data-themes="" data-resource-suffix="" data-rustdoc-version="1.79.0-nightly (385fa9d84 2024-04-04)" data-channel="nightly" data-search-js="search-ffac13a0df2b1870.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-e32f0c247825364d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-c97aec732c613ca4.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../darkfi/index.html">darkfi</a><span class="version">0.4.1</span></h2></div><h2 class="location"><a href="#">Module utils</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In darkfi::validator</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../../darkfi/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">darkfi</a>::<wbr><a href="../index.html">validator</a>::<wbr><a class="mod" href="#">utils</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/darkfi/validator/utils.rs.html#19-240">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Helper utilities</p>
</div></details><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.best_fork_index.html" title="fn darkfi::validator::utils::best_fork_index">best_fork_index</a></div><div class="desc docblock-short">Auxiliary function to find best ranked fork.
The best ranked fork is the one with the highest sum of
its blocks squared mining target distances, from max 32
bytes int. In case of a tie, the fork with the highest
sum of its blocks squared RandomX hash number distances,
from max 32 bytes int, wins.</div></li><li><div class="item-name"><a class="fn" href="fn.block_rank.html" title="fn darkfi::validator::utils::block_rank">block_rank</a></div><div class="desc docblock-short">Compute a block’s rank, assuming that its valid, based on provided mining target.
Block’s rank is the tuple of its squared mining target distance from max 32 bytes int,
along with its squared RandomX hash number distance from max 32 bytes int.
Genesis block has rank (0, 0).</div></li><li><div class="item-name"><a class="fn" href="fn.deploy_native_contracts.html" title="fn darkfi::validator::utils::deploy_native_contracts">deploy_native_contracts</a></div><div class="desc docblock-short">Deploy DarkFi native wasm contracts to provided blockchain overlay.
If overlay already contains the contracts, it will just open the
necessary db and trees, and give back what it has. This means that
on subsequent runs, our native contracts will already be in a deployed
state, so what we actually do here is a redeployment. This kind of
operation should only modify the contract’s state in case it wasn’t
deployed before (meaning the initial run). Otherwise, it shouldn’t
touch anything, or just potentially update the db schemas or whatever
is necessary. This logic should be handled in the init function of
the actual contract, so make sure the native contracts handle this well.</div></li><li><div class="item-name"><a class="fn" href="fn.find_extended_fork_index.html" title="fn darkfi::validator::utils::find_extended_fork_index">find_extended_fork_index</a></div><div class="desc docblock-short">Given a proposal, find the index of a fork chain it extends, along with the specific
extended proposal index. Additionally, check that proposal doesn’t already exists in any
fork chain.</div></li><li><div class="item-name"><a class="fn" href="fn.get_mid.html" title="fn darkfi::validator::utils::get_mid">get_mid</a></div><div class="desc docblock-short">Auxiliary function to calculate the middle value between provided u64 numbers</div></li><li><div class="item-name"><a class="fn" href="fn.median.html" title="fn darkfi::validator::utils::median">median</a></div><div class="desc docblock-short">Auxiliary function to calculate the median of a given <code>Vec&lt;u64&gt;</code>.
The function sorts the vector internally.</div></li></ul></section></div></main></body></html>